<script>
  /* globals $, updateGrid, Cookies, sums */
  const html = $('html');
  $(function() {
    $('#nightmode').click(function() {
      setTheme('night', 'night');
    });
  });
  $(function() {
    $('#retro').click(function() {
      setTheme('retro', 'night');
    });
  });
  $(function() {
    $('#no-theme').click(function() {
      setTheme(undefined, undefined, true);
    });
  });
  $(function() {
    $('#eidolon').click(function() {
      setTheme('eidolon', 'default', false);
    });
  });

  const setTheme = (themeName, superTheme, reset) => {
    const theme = $('#mode');
    if (!reset) {
      if (theme.hasClass(themeName)) {
        setTheme(false, false, true);
      } else {
        theme.attr('href', `css/bootstrap-${superTheme}.min.css?v=${sums[`css/bootstrap-${superTheme}.min.css`]}`);
        theme.removeClass();
        theme.addClass(themeName);
        html.removeClass(localStorage.mode);
        localStorage.mode = themeName;
        html.addClass(themeName);
      }
    } else {
      theme.attr('href', `css/bootstrap-default.min.css?v=${sums[`css/bootstrap-${superTheme}.min.css`]}`);
      theme.removeClass();
      html.removeClass(localStorage.mode);
      localStorage.mode = 'day';
      html.attr('data-theme', 'day');
      html.addClass('day');
    }
    if (typeof updateGrid !== 'undefined') {
      updateGrid();
    }
  };
</script>
